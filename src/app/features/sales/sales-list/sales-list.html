<app-page-header
  title="Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª"
  subtitle="Ø³Ø¬Ù„ Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø¨ÙŠØ¹"
  actionLabel="ØªØ³Ø¬ÙŠÙ„ Ø¨ÙŠØ¹"
  (action)="goToNew()"
/>

<div class="card">
  @if (loading()) {
    <app-loading-spinner />
  } @else if (sales().length === 0) {
    <div class="empty-state">
      <div class="empty-state-icon">ğŸ›’</div>
      <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¨ÙŠØ¹Ø§Øª Ù…Ø³Ø¬Ù„Ø© Ø¨Ø¹Ø¯.</p>
    </div>
  } @else {
    <div class="table-wrapper">
      <table>
        <thead>
          <tr>
            <th>#</th>
            <th>Ø§Ù„Ù‚Ø·Ø¹Ø©</th>
            <th>Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ø¨Ø§Ø¹Ø©</th>
            <th>Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø©</th>
            <th>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th>
            <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
            <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
          </tr>
        </thead>
        <tbody>
          @for (sale of sales(); track sale._id; let i = $index) {
            <tr>
              <td class="text-muted">{{ i + 1 }}</td>
              <td class="font-semibold">{{ sale.sparePartId?.name || 'â€”' }}</td>
              <td><span class="badge badge-primary">{{ sale.quantitySold }}</span></td>
              <td>{{ sale.unitPrice | number:'1.2-2' }} Ø¬.Ù…</td>
              <td class="font-semibold">{{ sale.totalPrice | number:'1.2-2' }} Ø¬.Ù…</td>
              <td class="text-muted text-sm">{{ sale.createdAt | date:'dd/MM/yyyy HH:mm' }}</td>
              <td>
                <button class="btn btn-danger btn-sm" (click)="confirmDelete(sale)">
                  ğŸ—‘ï¸ Ø­Ø°Ù
                </button>
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  }
</div>

@if (deleteTarget()) {
  <app-confirm-dialog
    message="Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¨ÙŠØ¹ Ù‡Ø°Ù‡ØŸ Ø³ÙŠØªÙ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„ÙƒÙ…ÙŠØ© Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø®Ø²ÙˆÙ†."
    (confirmed)="doDelete()"
    (cancelled)="cancelDelete()"
  />
}
