<app-page-header
  title="Ù‚Ø·Ø¹ Ø§Ù„ØºÙŠØ§Ø±"
  subtitle="Ø¥Ø¯Ø§Ø±Ø© Ù…Ø®Ø²ÙˆÙ† Ù‚Ø·Ø¹ Ø§Ù„ØºÙŠØ§Ø±"
  actionLabel="Ø¥Ø¶Ø§ÙØ© Ù‚Ø·Ø¹Ø©"
  (action)="goToNew()"
/>

<div class="card">
  <div class="search-bar mb-4">
    <span class="search-icon">ğŸ”</span>
    <input
      class="form-control"
      style="padding-inline-start:36px"
      type="text"
      placeholder="Ø§Ù„Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ù‚Ø·Ø¹Ø©..."
      [formControl]="searchControl"
    />
  </div>

  @if (loading()) {
    <app-loading-spinner />
  } @else if (parts().length === 0) {
    <div class="empty-state">
      <div class="empty-state-icon">ğŸ”§</div>
      <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù‚Ø·Ø¹ ØºÙŠØ§Ø±. Ø£Ø¶Ù Ù‚Ø·Ø¹Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„Ø¨Ø¯Ø¡.</p>
    </div>
  } @else {
    <div class="table-wrapper">
      <table>
        <thead>
          <tr>
            <th>#</th>
            <th>Ø§Ø³Ù… Ø§Ù„Ù‚Ø·Ø¹Ø©</th>
            <th>Ø§Ù„ÙƒÙ…ÙŠØ©</th>
            <th>Ø§Ù„Ø³Ø¹Ø±</th>
            <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
          </tr>
        </thead>
        <tbody>
          @for (part of parts(); track part._id; let i = $index) {
            <tr>
              <td class="text-muted">{{ i + 1 }}</td>
              <td class="font-semibold">{{ part.name }}</td>
              <td>
                <span
                  class="badge"
                  [class.badge-success]="part.quantity > 10"
                  [class.badge-warning]="part.quantity > 0 && part.quantity <= 10"
                  [class.badge-danger]="part.quantity === 0"
                >
                  {{ part.quantity }}
                </span>
              </td>
              <td>{{ part.price | number:'1.2-2' }} Ø¬.Ù…</td>
              <td>
                <div class="actions-cell">
                  <button class="btn btn-outline btn-sm" (click)="goToEdit(part._id)">
                    âœï¸ ØªØ¹Ø¯ÙŠÙ„
                  </button>
                  <button class="btn btn-danger btn-sm" (click)="confirmDelete(part)">
                    ğŸ—‘ï¸ Ø­Ø°Ù
                  </button>
                </div>
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  }
</div>

@if (deleteTarget()) {
  <app-confirm-dialog
    [message]="'Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø§Ù„Ù‚Ø·Ø¹Ø©: ' + deleteTarget()!.name + 'ØŸ'"
    (confirmed)="doDelete()"
    (cancelled)="cancelDelete()"
  />
}
